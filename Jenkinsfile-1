pipeline { 
    agent { 
        label 'slave1'
    }
    stage('Build') {
        steps {
            script {
                def commit = checkout scm
                // we set BRANCH_NAME to make when { branch } syntax work without multibranch job
                env.BRANCH_NAME = commit.GIT_BRANCH.replace('origin/', '')
                //actually build ...
            }
        }
    }
    stages {
        stage("Deploy") {
            when { 
                anyOf { branch 'main'; branch 'dev' 
                    
                }
            }
            steps {
                echo "Deploy! production."
            }
        }
    }
}
